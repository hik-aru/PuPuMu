<%= render 'shared/error_messages' %>
<%= render 'header' %>
<%= stylesheet_link_tag "dm/dm.css", :media => "all" %>

<link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
<script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<!------ Include the above in your HEAD tag ---------->

<hr class="">
<div class="container">
<h3 class=" text-center">Messaging</h3>
<div class="messaging">
      <div class="inbox_msg">
        <div class="inbox_people">
          <div class="headind_srch">
            <div class="recent_heading">
              <h4>Recent</h4>
            </div>
            
          </div>
					<div class="inbox_chat">
					<% if @messages.present? %>
            <% @messages.each do |m| %>
              <% if m.user_id != @current_user.id %>
            		<div class="chat_list">
            		  <div class="chat_people">
            		    <div class="chat_img"> <%= image_tag(m.user.image.to_s, :class => "img-circle img-sm") %> </div>
            		    <div class="chat_ib">
            		      <h5><%= m.user.user_name %><span class="chat_date"><%= m.created_at %></span></h5>
            		      <p><%= m.content %></p>
            		    </div>
            		  </div>
								</div>
							<% end %>
						<% end %>
					<% end %>
          </div>
        </div>
        <div class="mesgs">
					<div class="msg_history">
					<% if @messages.present? %>
            <% @messages.each do |m| %>
              <% if m.user_id != @current_user.id %>
            		<div class="incoming_msg">
            		  <div class="incoming_msg_img"> <%= image_tag(m.user.image.to_s, :class => "img-circle img-sm") %> </div>
            		  <div class="received_msg">
            		    <div class="received_withd_msg">
            		      <p><%= m.content %></p>
            		      <span class="time_date"><%= m.created_at %></span></div>
            		  </div>
								</div>
							<% else %>
								<div class="outgoing_msg">
              		<div class="sent_msg">
              	  	<p><%= m.content %></p>
              	  	<span class="time_date"><%= m.created_at %></span> </div>
            		</div>
							<% end %>
						<% end %>
					<% end %>
        	</div>
          <div class="type_msg">
						<div class="input_msg_write">
							<%= form_for @message do |f| %>								
								<%= f.text_field :content, :class => "write_msg", :placeholder => "Type a message"%>
								<%= f.hidden_field :room_id, :value => @room.id %>
								<%= button_tag :type => "submit", :class => "msg_send_btn" do %>
									<i class="fa fa-paper-plane-o"></i>
								<% end %>
							<% end %>
            </div>
          </div>
        </div>
			</div>
			
    </div></div>
